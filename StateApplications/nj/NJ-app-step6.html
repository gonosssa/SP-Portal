<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NJ TDI – Step 6: Signature & Submission</title>
    <link rel="stylesheet" href="../styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <img src="../assets/images/ShelterPoint.jpg" alt="ShelterPoint Life Insurance Company" style="height: 50px;">
                <p class="tagline">Application – Step 6 of 6</p>
            </div>
        </header>
        <main>
            <div class="form-section">
                <h2 class="section-title">Employer Agreement & Signature</h2>

                <form id="njStep6">
                    <!-- Item 8: Employer Signature -->
                    <div style="background: #FFF3CD; padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem; border-left: 4px solid var(--warning-color);">
                        <h3 style="color: var(--primary-color); margin-bottom: 1rem;">Employer Agreement and Signature <span class="required">*</span></h3>
                        
                        <div class="agreement-box" style="background: white;">
                            <p>The undersigned employer agrees to the establishment of the above Private Plan in accordance with the New Jersey Temporary Disability Benefits Law.</p>
                            
                            <p style="margin-top: 1rem;"><strong>Note:</strong> Pursuant to the NJAC 12:18-2.9(b), if an employer provides disability benefits through a multi-benefit plan that does not comply with the New Jersey Temporary Disability Benefits Law, the employer shall establish a separate plan, maintained solely for the purpose of complying with the provisions of the Law.</p>
                        </div>

                        <div class="alert-box error" style="margin-top: 1rem;">
                            <strong>⚠️ Important:</strong> Signatory must be one of the following approved titles: Owner, Partner, or Corporate Officer (Pres., V.P., Secy., Treas.). Any other title will result in rejection by the State of New Jersey.
                        </div>

                        <div class="form-row" style="margin-top: 1.5rem;">
                            <div class="form-group">
                                <label for="employerSignature">Employer's Signature <span class="required">*</span></label>
                                <input type="text" id="employerSignature" name="employerSignature" placeholder="Type your full name to sign" required>
                            </div>
                            <div class="form-group">
                                <label for="employerSignDate">Date <span class="required">*</span></label>
                                <input type="date" id="employerSignDate" name="employerSignDate" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="employerTitle">Title <span class="required">*</span></label>
                                <select id="employerTitle" name="employerTitle" required>
                                    <option value="">Select...</option>
                                    <option value="Owner">Owner</option>
                                    <option value="Partner">Partner</option>
                                    <option value="President">President</option>
                                    <option value="Vice President">Vice President</option>
                                    <option value="Secretary">Secretary</option>
                                    <option value="Treasurer">Treasurer</option>
                                </select>
                                <span class="help-text">Must be an approved title</span>
                            </div>
                            <div class="form-group">
                                <label for="employerPrintedName">Printed Name <span class="required">*</span></label>
                                <input type="text" id="employerPrintedName" name="employerPrintedName" required>
                            </div>
                        </div>

                        <div class="checkbox-item" style="margin-top: 1rem;">
                            <input type="checkbox" id="certifyEmployer" name="certifyEmployer" required>
                            <label for="certifyEmployer">I certify that I am authorized to sign on behalf of the employer and all information is accurate <span class="required">*</span></label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="button" class="btn-secondary" onclick="window.location.href='NJ-app-step5.html'">← Back</button>
                        <button type="button" class="btn-primary btn-full-width" onclick="saveAndFinish()">Submit Application →</button>
                    </div>
                </form>
            </div>
        </main>
        <footer>
            <p>© 2025 ShelterPoint Life Insurance Company</p>
        </footer>
    </div>
    <script>
        window.addEventListener('DOMContentLoaded', function(){
            const today = new Date().toISOString().split('T')[0];
            const dateEl = document.getElementById('employerSignDate');
            if (dateEl) dateEl.value = today;
        });

        function loadData(){
            const data = JSON.parse(sessionStorage.getItem('njApplicationData') || '{}');
            Object.keys(data).forEach(function(key){ 
                const el = document.getElementById(key);
                if (el) {
                    if (el.type === 'radio') {
                        const r = document.querySelector('input[name="' + el.name + '"][value="' + data[key] + '"]');
                        if (r) r.checked = true;
                    } else if (el.type === 'checkbox') {
                        el.checked = data[key] === 'on' || data[key] === true;
                    } else {
                        el.value = data[key];
                    }
                }
            });
        }

        function saveAndFinish(){
            const form = document.getElementById('njStep6');
            const fd = new FormData(form);
            
            if (!document.getElementById('certifyEmployer').checked) {
                alert('You must certify that you are authorized to sign and that all information is accurate.');
                return;
            }

            // Validate approved title
            const title = document.getElementById('employerTitle').value;
            const approvedTitles = ['Owner', 'Partner', 'President', 'Vice President', 'Secretary', 'Treasurer'];
            if (!approvedTitles.includes(title)) {
                alert('Please select an approved title. Other titles will result in rejection by the State of New Jersey.');
                return;
            }

            const existing = JSON.parse(sessionStorage.getItem('njApplicationData') || '{}');
            fd.forEach((v,k)=> existing[k]=v);
            sessionStorage.setItem('njApplicationData', JSON.stringify(existing));
            
            window.location.href = 'NJ-app-complete.html';
        }

        window.addEventListener('DOMContentLoaded', loadData);
    </script>
</body>
</html>

